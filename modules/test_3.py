import numpy as np
import matplotlib.pyplot as plt

# Данные
h = np.array([41.0, 37.45, 34.0, 31.7, 29.3, 26.5, 24.0, 21.6, 19.0, 16.0, 13.0, 10.0, 7.55, 4.0])
m1 = np.array([76.0, 84.0, 105.0, 116.0, 130.0, 165.0, 200.0, 250.0, 310.0, 440.0, 560.0, 780.0, 1225, 1720.0])
m2 = np.array([74.0, 86.0, 103.0, 118.0, 136.0, 175.0, 287.0, 249.0, 310.0, 445.0, 590.0, 780.0, 1125, 1700.0])
m3 = np.array([74.0, 85.0, 105.0, 118.0, 130.0, 159.0, 192.0, 260.0, 329.0, 425.0, 570.0, 800.0, 1214, 1750.0])

# Средние значения масс
m_avg = (m1 + m2 + m3) / 3

# Гиперболическая аппроксимация y = a / x + b
# Преобразуем к линейной форме и используем полифит
x_transformed = 1 / h  # Переменная для гиперболической аппроксимации
coefficients = np.polyfit(x_transformed, m_avg, 1)
a, b = coefficients

# Вычисляем аппроксимированные значения
m_approx = a / h + b

# Вычисляем относительную ошибку для каждой точки
relative_error = np.abs((m_avg - m_approx) / m_avg) * 100  # В процентах

# Печатаем среднюю относительную ошибку
mean_relative_error = np.mean(relative_error)
print(f"Средняя относительная ошибка: {mean_relative_error:.2f}%")

# Построение графика
plt.figure(figsize=(10, 6))
plt.plot(h, m_avg, 'bo-', label='Исходные данные')
plt.plot(h, m_approx, 'g--', label='Гиперболическая аппроксимация')
plt.xlabel('Расстояние между магнитами (h)')
plt.ylabel('Средняя масса (m)')
plt.legend()
plt.title('Гиперболическая аппроксимация и исходные данные')
plt.grid(True)
plt.show()
